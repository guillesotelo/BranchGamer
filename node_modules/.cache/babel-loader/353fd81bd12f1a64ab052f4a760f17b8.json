{"ast":null,"code":"import { createReducer, createAsyncThunk, createAction } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { addOneToQuantity, removeOneFromQuantity } from \"../utils\";\nexport const getItems = createAsyncThunk(\"GET_ITEMS\", async (data, thunkAPI) => {\n  try {\n    const {\n      isLogIn\n    } = thunkAPI.getState();\n\n    if (isLogIn) {\n      const {\n        token,\n        id\n      } = data;\n      const req = await axios.get(`/api/cart/items/${id}`, {\n        headers: {\n          authorization: token\n        }\n      });\n      return req.data;\n    } else {\n      const items = JSON.parse(window.localStorage.getItem(\"cart-items-no-log\")) || [];\n      console.log(\"ITEMS\", items);\n      return items;\n    }\n  } catch (err) {\n    throw err;\n  }\n});\nexport const addItem = createAsyncThunk(\"ADD_ITEM\", async (data, thunkAPI) => {\n  try {\n    const {\n      token,\n      cartInUse,\n      isLogIn\n    } = thunkAPI.getState();\n\n    if (isLogIn) {\n      const body = {\n        carritoId: cartInUse.id,\n        productId: data.id\n      };\n      const req = await axios.post(\"/api/cart/add\", body, {\n        headers: {\n          authorization: token\n        }\n      });\n      const {\n        productId,\n        quantity\n      } = req.data;\n      return {\n        productId,\n        quantity\n      };\n    } else {\n      const items = JSON.parse(window.localStorage.getItem(\"cart-items-no-log\")) || [];\n      const obj = {\n        productId: data.id,\n        quantity: 1\n      };\n      const newItems = [...items, obj];\n      window.localStorage.setItem(\"cart-items-no-log\", JSON.stringify(newItems));\n      return obj;\n    }\n  } catch (err) {\n    throw err;\n  }\n});\nexport const removeItem = createAsyncThunk(\"REMOVE_ITEM\", async (data, thunkAPI) => {\n  try {\n    const {\n      token,\n      cartInUse,\n      isLogIn\n    } = thunkAPI.getState();\n\n    if (isLogIn) {\n      await axios.delete(`/api/cart/${cartInUse.id}/${data.id}`, {\n        headers: {\n          authorization: token\n        }\n      });\n    } else {\n      const items = JSON.parse(window.localStorage.getItem(\"cart-items-no-log\")) || [];\n      const newItems = items.filter(item => item.productId !== data.id);\n      window.localStorage.setItem(\"cart-items-no-log\", JSON.stringify(newItems));\n    }\n\n    return data;\n  } catch (err) {\n    throw err;\n  }\n});\nexport const quantityRemove = createAsyncThunk(\"QUANTITY_REMOVE_ITEM\", async (data, thunkAPI) => {\n  try {\n    const {\n      token,\n      cartInUse,\n      isLogIn\n    } = thunkAPI.getState();\n\n    if (isLogIn) {\n      const body = {\n        carritoId: cartInUse.id,\n        productId: data.id,\n        type: \"remove\"\n      };\n      await axios.put(`/api/cart`, body, {\n        headers: {\n          authorization: token\n        }\n      });\n      const req = await axios.get(`/api/cart/items/${cartInUse.id}`, {\n        headers: {\n          authorization: token\n        }\n      });\n      return req.data;\n    } else {\n      const items = JSON.parse(window.localStorage.getItem(\"cart-items-no-log\"));\n      const newItems = removeOneFromQuantity(items, data.id);\n      window.localStorage.setItem(\"cart-items-no-log\", JSON.stringify(newItems));\n      console.log(\"NEWITEMS\", newItems);\n      return newItems;\n    }\n  } catch (err) {\n    throw err;\n  }\n});\nexport const quantityAdd = createAsyncThunk(\"QUANTITY_ADD_ITEM\", async (data, thunkAPI) => {\n  try {\n    const {\n      token,\n      cartInUse,\n      isLogIn\n    } = thunkAPI.getState();\n\n    if (isLogIn) {\n      const body = {\n        carritoId: cartInUse.id,\n        productId: data.id,\n        type: \"add\"\n      };\n      await axios.put(`/api/cart`, body, {\n        headers: {\n          authorization: token\n        }\n      });\n      const req = await axios.get(`/api/cart/items/${cartInUse.id}`, {\n        headers: {\n          authorization: token\n        }\n      });\n      return req.data;\n    } else {\n      const items = JSON.parse(window.localStorage.getItem(\"cart-items-no-log\"));\n      const newItems = addOneToQuantity(items, data.id);\n      window.localStorage.setItem(\"cart-items-no-log\", JSON.stringify(newItems));\n      console.log(\"NEWITEMS\", newItems);\n      return newItems;\n    }\n  } catch (err) {\n    throw err;\n  }\n});\nexport const setCarritoItemsVacio = createAction(\"set_CarritoItemsVacio\");\nconst cartReducer = createReducer([], {\n  [setCarritoItemsVacio]: (state, action) => [],\n  [getItems.fulfilled]: (state, action) => action.payload,\n  [addItem.fulfilled]: (state, action) => [...state, action.payload],\n  [removeItem.fulfilled]: (state, action) => state.filter(item => item.productId !== action.payload.id),\n  [quantityAdd.fulfilled]: (state, action) => action.payload,\n  [quantityRemove.fulfilled]: (state, action) => action.payload\n});\nexport default cartReducer;","map":{"version":3,"sources":["/Users/guillermosotelo/Documents/P5/BC/branch-and-gamer/src/store/cartReducer.js"],"names":["createReducer","createAsyncThunk","createAction","axios","addOneToQuantity","removeOneFromQuantity","getItems","data","thunkAPI","isLogIn","getState","token","id","req","get","headers","authorization","items","JSON","parse","window","localStorage","getItem","console","log","err","addItem","cartInUse","body","carritoId","productId","post","quantity","obj","newItems","setItem","stringify","removeItem","delete","filter","item","quantityRemove","type","put","quantityAdd","setCarritoItemsVacio","cartReducer","state","action","fulfilled","payload"],"mappings":"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","sourcesContent":["import { createReducer, createAsyncThunk, createAction } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { addOneToQuantity, removeOneFromQuantity } from \"../utils\";\n\nexport const getItems = createAsyncThunk(\n  \"GET_ITEMS\",\n  async (data, thunkAPI) => {\n    try {\n      const { isLogIn } = thunkAPI.getState();\n\n      if (isLogIn) {\n        const { token, id } = data;\n\n        const req = await axios.get(`/api/cart/items/${id}`, {\n          headers: { authorization: token },\n        });\n\n        return req.data;\n      } else {\n        const items =\n          JSON.parse(window.localStorage.getItem(\"cart-items-no-log\")) || [];\n\n        console.log(\"ITEMS\", items);\n\n        return items;\n      }\n    } catch (err) {\n      throw err;\n    }\n  }\n);\n\nexport const addItem = createAsyncThunk(\"ADD_ITEM\", async (data, thunkAPI) => {\n  try {\n    const { token, cartInUse, isLogIn } = thunkAPI.getState();\n\n    if (isLogIn) {\n      const body = {\n        carritoId: cartInUse.id,\n        productId: data.id,\n      };\n\n      const req = await axios.post(\"/api/cart/add\", body, {\n        headers: { authorization: token },\n      });\n\n      const { productId, quantity } = req.data;\n      return { productId, quantity };\n    } else {\n      const items =\n        JSON.parse(window.localStorage.getItem(\"cart-items-no-log\")) || [];\n\n      const obj = { productId: data.id, quantity: 1 };\n\n      const newItems = [...items, obj];\n\n      window.localStorage.setItem(\n        \"cart-items-no-log\",\n        JSON.stringify(newItems)\n      );\n      return obj;\n    }\n  } catch (err) {\n    throw err;\n  }\n});\n\nexport const removeItem = createAsyncThunk(\n  \"REMOVE_ITEM\",\n  async (data, thunkAPI) => {\n    try {\n      const { token, cartInUse, isLogIn } = thunkAPI.getState();\n\n      if (isLogIn) {\n        await axios.delete(`/api/cart/${cartInUse.id}/${data.id}`, {\n          headers: { authorization: token },\n        });\n      } else {\n        const items =\n          JSON.parse(window.localStorage.getItem(\"cart-items-no-log\")) || [];\n\n        const newItems = items.filter((item) => item.productId !== data.id);\n\n        window.localStorage.setItem(\n          \"cart-items-no-log\",\n          JSON.stringify(newItems)\n        );\n      }\n      return data;\n    } catch (err) {\n      throw err;\n    }\n  }\n);\n\nexport const quantityRemove = createAsyncThunk(\n  \"QUANTITY_REMOVE_ITEM\",\n  async (data, thunkAPI) => {\n    try {\n      const { token, cartInUse, isLogIn } = thunkAPI.getState();\n      if (isLogIn) {\n        const body = {\n          carritoId: cartInUse.id,\n          productId: data.id,\n          type: \"remove\",\n        };\n\n        await axios.put(`/api/cart`, body, {\n          headers: { authorization: token },\n        });\n\n        const req = await axios.get(`/api/cart/items/${cartInUse.id}`, {\n          headers: { authorization: token },\n        });\n\n        return req.data;\n      } else {\n        const items = JSON.parse(\n          window.localStorage.getItem(\"cart-items-no-log\")\n        );\n\n        const newItems = removeOneFromQuantity(items, data.id);\n\n        window.localStorage.setItem(\n          \"cart-items-no-log\",\n          JSON.stringify(newItems)\n        );\n        console.log(\"NEWITEMS\", newItems);\n        return newItems;\n      }\n    } catch (err) {\n      throw err;\n    }\n  }\n);\n\nexport const quantityAdd = createAsyncThunk(\n  \"QUANTITY_ADD_ITEM\",\n  async (data, thunkAPI) => {\n    try {\n      const { token, cartInUse, isLogIn } = thunkAPI.getState();\n      if (isLogIn) {\n        const body = {\n          carritoId: cartInUse.id,\n          productId: data.id,\n          type: \"add\",\n        };\n\n        await axios.put(`/api/cart`, body, {\n          headers: { authorization: token },\n        });\n\n        const req = await axios.get(`/api/cart/items/${cartInUse.id}`, {\n          headers: { authorization: token },\n        });\n\n        return req.data;\n      } else {\n        const items = JSON.parse(\n          window.localStorage.getItem(\"cart-items-no-log\")\n        );\n\n        const newItems = addOneToQuantity(items, data.id);\n\n        window.localStorage.setItem(\n          \"cart-items-no-log\",\n          JSON.stringify(newItems)\n        );\n        console.log(\"NEWITEMS\", newItems);\n        return newItems;\n      }\n    } catch (err) {\n      throw err;\n    }\n  }\n);\n\nexport const setCarritoItemsVacio = createAction(\"set_CarritoItemsVacio\")\n\nconst cartReducer = createReducer([], {\n  [setCarritoItemsVacio]: (state, action) => [],\n  [getItems.fulfilled]: (state, action) => action.payload,\n  [addItem.fulfilled]: (state, action) => [...state, action.payload],\n  [removeItem.fulfilled]: (state, action) =>\n    state.filter((item) => item.productId !== action.payload.id),\n  [quantityAdd.fulfilled]: (state, action) => action.payload,\n  [quantityRemove.fulfilled]: (state, action) => action.payload,\n});\n\nexport default cartReducer;\n"]},"metadata":{},"sourceType":"module"}